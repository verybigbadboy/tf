{
  "version": 4,
  "terraform_version": "0.12.29",
  "serial": 64,
  "lineage": "dcfccee9-f4e4-862d-580a-8b2fc0a5db55",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "template_cloudinit_config",
      "name": "dev_cloud_init",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base64_encode": false,
            "gzip": false,
            "id": "2505776114",
            "part": [
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n",
                "content_type": "text/cloud-config",
                "filename": "base.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n",
                "content_type": "text/cloud-config",
                "filename": "master.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname dev\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: dev\nfqdn: dev.bad\n",
                "content_type": "text/cloud-config",
                "filename": "hostname.cfg",
                "merge_type": ""
              }
            ],
            "rendered": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname dev\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: dev\nfqdn: dev.bad\n\r\n--MIMEBOUNDARY--\r\n"
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_cloudinit_config",
      "name": "gitea_cloud_init",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base64_encode": false,
            "gzip": false,
            "id": "1438963677",
            "part": [
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n",
                "content_type": "text/cloud-config",
                "filename": "base.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n",
                "content_type": "text/cloud-config",
                "filename": "zabbix_agent.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: git\n    shell: /sbin/nologin\n    lock_passwd: true\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\n\npackages:\n  - mysql-client\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: giteadata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /gitea, auto, \"defaults\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      server {\n        listen          80;\n        server_name     gitea.bad;\n        location / {\n          proxy_pass      http://localhost:3000;\n        }\n      }\n\n  - owner: root:root\n    path: /gitea.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%', \n            'SET GLOBAL innodb_file_per_table = ON, \n                        innodb_file_format = Barracuda, \n                        innodb_large_prefix = ON,\n                        innodb_default_row_format = dynamic;', \n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1; \n\n      CREATE DATABASE IF NOT EXISTS gitea CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;\n      CREATE USER IF NOT EXISTS 'gitea'@'%' IDENTIFIED BY 'GiteaPasswordIsComplex123';\n      GRANT ALL ON gitea.* TO gitea@'%';\n      flush privileges;\n\n  - owner: root:root\n    path: /etc/gitea/app.ini\n    content: |\n      APP_NAME = Gitea: Git with a cup of tea\n      RUN_USER = git\n      RUN_MODE = prod\n\n      [oauth2]\n      JWT_SECRET = rhjIEqkeVoGfg_eAeFhl2CMNvyogLaiGJ65T-r3m8Tg\n\n      [security]\n      INTERNAL_TOKEN = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYmYiOjE1ODIzMjQ3Mzh9.SxIK4tJRlCFMZ3gxqL0w-2sZI1yT5R3HB9RyTGeLHd4\n      INSTALL_LOCK   = true\n      SECRET_KEY     = 1V2L7Ff2YBU6cVbrr1uXX8W0c47c4EleyzdGTPR80ZUeczDeYt9K3TvZBFbyALBG\n\n      [database]\n      DB_TYPE  = mysql\n      HOST     = mysql.bad:3306\n      NAME     = gitea\n      USER     = gitea\n      PASSWD   = GiteaPasswordIsComplex123\n      SSL_MODE = disable\n      CHARSET  = utf8mb4\n      PATH     = /gitea/data/gitea.db\n\n      [repository]\n      ROOT = /gitea/git-repo/\n\n      [server]\n      SSH_DOMAIN       = gitea.bad\n      DOMAIN           = gitea.bad\n      HTTP_PORT        = 3000\n      ROOT_URL         = http://gitea.bad/\n      DISABLE_SSH      = false\n      START_SSH_SERVER = true\n      SSH_PORT         = 22\n      LFS_START_SERVER = true\n      LFS_CONTENT_PATH = /gitea/git-lfs/\n      LFS_JWT_SECRET   = V81hY-fG_5u8CensrkUMfX_0C4ag8tU5lVHQeEITQPs\n      OFFLINE_MODE     = true\n\n      [mailer]\n      ENABLED = false\n\n      [service]\n      REGISTER_EMAIL_CONFIRM            = false\n      ENABLE_NOTIFY_MAIL                = false\n      DISABLE_REGISTRATION              = false\n      ALLOW_ONLY_EXTERNAL_REGISTRATION  = false\n      ENABLE_CAPTCHA                    = false\n      REQUIRE_SIGNIN_VIEW               = false\n      DEFAULT_KEEP_EMAIL_PRIVATE        = false\n      DEFAULT_ALLOW_CREATE_ORGANIZATION = true\n      DEFAULT_ENABLE_TIMETRACKING       = true\n      NO_REPLY_ADDRESS                  = noreply.localhost\n\n      [picture]\n      DISABLE_GRAVATAR        = true\n      ENABLE_FEDERATED_AVATAR = false\n\n      [openid]\n      ENABLE_OPENID_SIGNIN = false\n      ENABLE_OPENID_SIGNUP = false\n\n      [session]\n      PROVIDER = file\n\n      [log]\n      MODE      = file\n      LEVEL     = info\n      ROOT_PATH = /gitea/log/\n\n\n  - owner: root:root\n    path: /etc/systemd/system/gitea.service\n    content: |\n      [Unit]\n      Description=Gitea (Git with a cup of tea)\n      After=syslog.target\n      After=network.target\n\n      [Service]\n      RestartSec=2s\n      Type=simple\n      User=git\n      Group=git\n      WorkingDirectory=/gitea/\n      ExecStart=/usr/local/bin/gitea web -c /etc/gitea/app.ini\n      Restart=always\n      Environment=USER=git HOME=/home/git GITEA_WORK_DIR=/gitea\n      AmbientCapabilities=CAP_NET_BIND_SERVICE\n      CapabilityBoundingSet=CAP_NET_BIND_SERVICE\n      PrivateUsers=false\n\n      [Install]\n      WantedBy=multi-user.target\n\nruncmd:\n  - systemctl disable ssh\n  - service ssh stop\n  - service nginx restart\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -h mysql.bad -uroot -pBad123 \u003c /gitea.sql\n  - mount /gitea || true\n  - wget https://dl.gitea.io/gitea/1.11.1/gitea-1.11.1-linux-amd64 -P/tmp\n  - mv /tmp/gitea-1.11.1-linux-amd64 /usr/local/bin/gitea\n  - sudo chmod +x /usr/local/bin/gitea\n  - mkdir -p /gitea/custom\n  - mkdir -p /gitea/data\n  - mkdir -p /gitea/log\n  - chown -R git:git /gitea/\n  - chmod -R 750 /gitea/\n  - mkdir /etc/gitea\n  - chown root:git /etc/gitea\n  - chmod 770 /etc/gitea\n  - systemctl daemon-reload\n  - systemctl enable gitea\n  - systemctl start gitea\n",
                "content_type": "text/cloud-config",
                "filename": "master.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname gitea\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: gitea\nfqdn: gitea.bad\n",
                "content_type": "text/cloud-config",
                "filename": "hostname.cfg",
                "merge_type": ""
              }
            ],
            "rendered": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: git\n    shell: /sbin/nologin\n    lock_passwd: true\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\n\npackages:\n  - mysql-client\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: giteadata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /gitea, auto, \"defaults\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      server {\n        listen          80;\n        server_name     gitea.bad;\n        location / {\n          proxy_pass      http://localhost:3000;\n        }\n      }\n\n  - owner: root:root\n    path: /gitea.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%', \n            'SET GLOBAL innodb_file_per_table = ON, \n                        innodb_file_format = Barracuda, \n                        innodb_large_prefix = ON,\n                        innodb_default_row_format = dynamic;', \n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1; \n\n      CREATE DATABASE IF NOT EXISTS gitea CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;\n      CREATE USER IF NOT EXISTS 'gitea'@'%' IDENTIFIED BY 'GiteaPasswordIsComplex123';\n      GRANT ALL ON gitea.* TO gitea@'%';\n      flush privileges;\n\n  - owner: root:root\n    path: /etc/gitea/app.ini\n    content: |\n      APP_NAME = Gitea: Git with a cup of tea\n      RUN_USER = git\n      RUN_MODE = prod\n\n      [oauth2]\n      JWT_SECRET = rhjIEqkeVoGfg_eAeFhl2CMNvyogLaiGJ65T-r3m8Tg\n\n      [security]\n      INTERNAL_TOKEN = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYmYiOjE1ODIzMjQ3Mzh9.SxIK4tJRlCFMZ3gxqL0w-2sZI1yT5R3HB9RyTGeLHd4\n      INSTALL_LOCK   = true\n      SECRET_KEY     = 1V2L7Ff2YBU6cVbrr1uXX8W0c47c4EleyzdGTPR80ZUeczDeYt9K3TvZBFbyALBG\n\n      [database]\n      DB_TYPE  = mysql\n      HOST     = mysql.bad:3306\n      NAME     = gitea\n      USER     = gitea\n      PASSWD   = GiteaPasswordIsComplex123\n      SSL_MODE = disable\n      CHARSET  = utf8mb4\n      PATH     = /gitea/data/gitea.db\n\n      [repository]\n      ROOT = /gitea/git-repo/\n\n      [server]\n      SSH_DOMAIN       = gitea.bad\n      DOMAIN           = gitea.bad\n      HTTP_PORT        = 3000\n      ROOT_URL         = http://gitea.bad/\n      DISABLE_SSH      = false\n      START_SSH_SERVER = true\n      SSH_PORT         = 22\n      LFS_START_SERVER = true\n      LFS_CONTENT_PATH = /gitea/git-lfs/\n      LFS_JWT_SECRET   = V81hY-fG_5u8CensrkUMfX_0C4ag8tU5lVHQeEITQPs\n      OFFLINE_MODE     = true\n\n      [mailer]\n      ENABLED = false\n\n      [service]\n      REGISTER_EMAIL_CONFIRM            = false\n      ENABLE_NOTIFY_MAIL                = false\n      DISABLE_REGISTRATION              = false\n      ALLOW_ONLY_EXTERNAL_REGISTRATION  = false\n      ENABLE_CAPTCHA                    = false\n      REQUIRE_SIGNIN_VIEW               = false\n      DEFAULT_KEEP_EMAIL_PRIVATE        = false\n      DEFAULT_ALLOW_CREATE_ORGANIZATION = true\n      DEFAULT_ENABLE_TIMETRACKING       = true\n      NO_REPLY_ADDRESS                  = noreply.localhost\n\n      [picture]\n      DISABLE_GRAVATAR        = true\n      ENABLE_FEDERATED_AVATAR = false\n\n      [openid]\n      ENABLE_OPENID_SIGNIN = false\n      ENABLE_OPENID_SIGNUP = false\n\n      [session]\n      PROVIDER = file\n\n      [log]\n      MODE      = file\n      LEVEL     = info\n      ROOT_PATH = /gitea/log/\n\n\n  - owner: root:root\n    path: /etc/systemd/system/gitea.service\n    content: |\n      [Unit]\n      Description=Gitea (Git with a cup of tea)\n      After=syslog.target\n      After=network.target\n\n      [Service]\n      RestartSec=2s\n      Type=simple\n      User=git\n      Group=git\n      WorkingDirectory=/gitea/\n      ExecStart=/usr/local/bin/gitea web -c /etc/gitea/app.ini\n      Restart=always\n      Environment=USER=git HOME=/home/git GITEA_WORK_DIR=/gitea\n      AmbientCapabilities=CAP_NET_BIND_SERVICE\n      CapabilityBoundingSet=CAP_NET_BIND_SERVICE\n      PrivateUsers=false\n\n      [Install]\n      WantedBy=multi-user.target\n\nruncmd:\n  - systemctl disable ssh\n  - service ssh stop\n  - service nginx restart\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -h mysql.bad -uroot -pBad123 \u003c /gitea.sql\n  - mount /gitea || true\n  - wget https://dl.gitea.io/gitea/1.11.1/gitea-1.11.1-linux-amd64 -P/tmp\n  - mv /tmp/gitea-1.11.1-linux-amd64 /usr/local/bin/gitea\n  - sudo chmod +x /usr/local/bin/gitea\n  - mkdir -p /gitea/custom\n  - mkdir -p /gitea/data\n  - mkdir -p /gitea/log\n  - chown -R git:git /gitea/\n  - chmod -R 750 /gitea/\n  - mkdir /etc/gitea\n  - chown root:git /etc/gitea\n  - chmod 770 /etc/gitea\n  - systemctl daemon-reload\n  - systemctl enable gitea\n  - systemctl start gitea\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname gitea\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: gitea\nfqdn: gitea.bad\n\r\n--MIMEBOUNDARY--\r\n"
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_cloudinit_config",
      "name": "minio_cloud_init",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base64_encode": false,
            "gzip": false,
            "id": "1474219625",
            "part": [
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n",
                "content_type": "text/cloud-config",
                "filename": "base.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n",
                "content_type": "text/cloud-config",
                "filename": "zabbix_agent.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: minio-user\n    shell: /sbin/nologin\n    lock_passwd: true\n\nssh_pwauth: True\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: miniodata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /minio, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nwrite_files:\n  - owner: root:root\n    path: /etc/default/minio\n    content: |\n      MINIO_VOLUMES=/minio\n      MINIO_OPTS=\"-C /etc/minio --address :80\"\n      MINIO_ACCESS_KEY=bad\n      MINIO_SECRET_KEY=Bad12345\n\n  - owner: root:root\n    path: /etc/systemd/system/minio.service\n    content: |\n      [Unit]\n      Description=MinIO\n      Documentation=https://docs.min.io\n      Wants=network-online.target\n      After=network-online.target\n      AssertFileIsExecutable=/usr/local/bin/minio\n\n      [Service]\n      WorkingDirectory=/usr/local/\n\n      User=minio-user\n      Group=minio-user\n\n      EnvironmentFile=/etc/default/minio\n      ExecStartPre=/bin/bash -c \"if [ -z \\\"${MINIO_VOLUMES}\\\" ]; then echo \\\"Variable MINIO_VOLUMES not set in /etc/default/minio\\\"; exit 1; fi\"\n\n      ExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES\n\n      # Let systemd restart this service always\n      Restart=always\n\n      # Specifies the maximum file descriptor number that can be opened by this process\n      LimitNOFILE=65536\n\n      # Disable timeout logic and wait until process is stopped\n      TimeoutStopSec=infinity\n      SendSIGKILL=no\n\n      [Install]\n      WantedBy=multi-user.target\n\n      # Built for ${project.name}-${project.version} (${project.name})\n\nruncmd:\n  - chown minio-user /minio\n  - chmod u+rxw /minio\n  - wget https://dl.minio.io/server/minio/release/linux-amd64/minio -P/tmp/\n  - wget https://dl.min.io/client/mc/release/linux-amd64/mc -P/tmp/\n  - chmod +x /tmp/minio\n  - chmod +x /tmp/mc\n  - mv /tmp/minio /usr/local/bin\n  - setcap cap_net_bind_service=+ep /usr/local/bin/minio\n  - mv /tmp/mc /usr/local/bin\n  - systemctl daemon-reload\n  - systemctl enable minio\n  - systemctl start minio\n  - mc config host add home http://localhost:80 bad Bad12345 --api \"s3v4\" --lookup \"dns\"\n  - mc admin user add home crash Crash12345\n",
                "content_type": "text/cloud-config",
                "filename": "master.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname minio\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: minio\nfqdn: minio.bad\n",
                "content_type": "text/cloud-config",
                "filename": "hostname.cfg",
                "merge_type": ""
              }
            ],
            "rendered": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: minio-user\n    shell: /sbin/nologin\n    lock_passwd: true\n\nssh_pwauth: True\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: miniodata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /minio, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nwrite_files:\n  - owner: root:root\n    path: /etc/default/minio\n    content: |\n      MINIO_VOLUMES=/minio\n      MINIO_OPTS=\"-C /etc/minio --address :80\"\n      MINIO_ACCESS_KEY=bad\n      MINIO_SECRET_KEY=Bad12345\n\n  - owner: root:root\n    path: /etc/systemd/system/minio.service\n    content: |\n      [Unit]\n      Description=MinIO\n      Documentation=https://docs.min.io\n      Wants=network-online.target\n      After=network-online.target\n      AssertFileIsExecutable=/usr/local/bin/minio\n\n      [Service]\n      WorkingDirectory=/usr/local/\n\n      User=minio-user\n      Group=minio-user\n\n      EnvironmentFile=/etc/default/minio\n      ExecStartPre=/bin/bash -c \"if [ -z \\\"${MINIO_VOLUMES}\\\" ]; then echo \\\"Variable MINIO_VOLUMES not set in /etc/default/minio\\\"; exit 1; fi\"\n\n      ExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES\n\n      # Let systemd restart this service always\n      Restart=always\n\n      # Specifies the maximum file descriptor number that can be opened by this process\n      LimitNOFILE=65536\n\n      # Disable timeout logic and wait until process is stopped\n      TimeoutStopSec=infinity\n      SendSIGKILL=no\n\n      [Install]\n      WantedBy=multi-user.target\n\n      # Built for ${project.name}-${project.version} (${project.name})\n\nruncmd:\n  - chown minio-user /minio\n  - chmod u+rxw /minio\n  - wget https://dl.minio.io/server/minio/release/linux-amd64/minio -P/tmp/\n  - wget https://dl.min.io/client/mc/release/linux-amd64/mc -P/tmp/\n  - chmod +x /tmp/minio\n  - chmod +x /tmp/mc\n  - mv /tmp/minio /usr/local/bin\n  - setcap cap_net_bind_service=+ep /usr/local/bin/minio\n  - mv /tmp/mc /usr/local/bin\n  - systemctl daemon-reload\n  - systemctl enable minio\n  - systemctl start minio\n  - mc config host add home http://localhost:80 bad Bad12345 --api \"s3v4\" --lookup \"dns\"\n  - mc admin user add home crash Crash12345\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname minio\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: minio\nfqdn: minio.bad\n\r\n--MIMEBOUNDARY--\r\n"
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_cloudinit_config",
      "name": "mssymbols_cloud_init",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base64_encode": false,
            "gzip": false,
            "id": "3116675993",
            "part": [
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n",
                "content_type": "text/cloud-config",
                "filename": "base.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n",
                "content_type": "text/cloud-config",
                "filename": "zabbix_agent.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\npackages:\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mssymbolsdata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /proxy-cache, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      proxy_cache_path /proxy-cache keys_zone=data:10m inactive=10000d;\n      client_max_body_size 200M;\n\n      resolver 8.8.8.8;\n\n      server {\n        listen 80 default_server;\n        server_name mssymbols.bad;\n\n        location / {\n          proxy_redirect off;\n          proxy_cache data;\n          proxy_cache_valid 200 404 406 10000d;\n          proxy_pass http://msdl.microsoft.com;\n          proxy_intercept_errors on;\n          error_page 301 302 307 = @handle_redirect;\n        }\n\n        location @handle_redirect {\n          set $saved_redirect_location '$upstream_http_location';\n          set $original_uri $uri;\n          set $orig_loc $upstream_http_location;\n          proxy_pass $orig_loc;\n          proxy_cache data;\n          proxy_cache_key $original_uri;\n          proxy_cache_valid 200 206 10000d;\n        }\n      }\n\nruncmd:\n  - mount /proxy-cache || true\n  - chmod -R 777 /proxy-cache\n",
                "content_type": "text/cloud-config",
                "filename": "master.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname mssymbols\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: mssymbols\nfqdn: mssymbols.bad\n",
                "content_type": "text/cloud-config",
                "filename": "hostname.cfg",
                "merge_type": ""
              }
            ],
            "rendered": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        mQGiBFCNJaYRBAC4nIW8o2NyOIswb82Xn3AYSMUcNZuKB2fMtpu0WxSXIRiX2BwC\n        YXx8cIEQVYtLRBL5o0JdmoNCjW6jd5fOVem3EmOcPksvzzRWonIgFHf4EI2n1KJc\n        JXX/nDC+eoh5xW35mRNFN/BEJHxxiRGGbp2MCnApwgrZLhOujaCGAwavGwCgiG4D\n        wKMZ4xX6Y2Gv3MSuzMIT0bcEAKYn3WohS+udp0yC3FHDj+oxfuHpklu1xuI3y6ha\n        402aEFahNi3wr316ukgdPAYLbpz76ivoouTJ/U2MqbNLjAspDvlnHXXyqPM5GC6K\n        jtXPqNrRMUCrwisoAhorGUg/+S5pyXwsWcJ6EKmA80pR9HO+TbsELE5bGe/oc238\n        t/2oBAC3zcQ46wPvXpMCNFb+ED71qDOlnDYaaAPbjgkvnp+WN6nZFFyevjx180Kw\n        qWOLnlNP6JOuFW27MP75MDPDpbAAOVENp6qnuW9dxXTN80YpPLKUxrQS8vWPnzkY\n        WtUfF75pEOACFVTgXIqEgW0E6oww2HJi9zF5fS8IlFHJztNYtbQgWmFiYml4IFNJ\n        QSA8cGFja2FnZXJAemFiYml4LmNvbT6IYAQTEQIAIAUCUI0lpgIbAwYLCQgHAwIE\n        FQIIAwQWAgMBAh4BAheAAAoJENE9WOR56l7UhUwAmgIGZ39U6D2w2oIWDD8m7KV3\n        oI06AJ9EnOxMMlxEjTkt9lEvGhEX1bEh7bkBDQRQjSWmEAQAqx+ecOzBbhqMq5hU\n        l39cJ6l4aocz6EZ9mSSoF/g+HFz6WYnPAfRaYyfLmZdtF5rGBDD4ysalYG5yD59R\n        Mv5tNVf/CEx+JAPMhp6JCBkGRaH+xHws4eBPGkea4rGNVP3L3rA7g+c1YXZICGRI\n        OOH7CIzIZ/w6aFGsPp7xM35ogncAAwUD/3s8Nc1OLDy81DC6rGpxfEURd5pvd/j0\n        D5Di0WSBEcHXp5nThDz6ro/Vr0/FVIBtT97tmBHX27yBS3PqxxNRIjZ0GSWQqdws\n        Q8o3YT+RHjBugXn8CzTOvIn+2QNMA8EtGIZPpCblJv8q6MFPi9m7avQxguMqufgg\n        fAk7377Rt9RqiEkEGBECAAkFAlCNJaYCGwwACgkQ0T1Y5HnqXtQx4wCfcJZINKVq\n        kQIoV3KTQAIzr6IvbZoAn12XXt4GP89xHuzPDZ86YJVAgnfKmQENBFeIdv0BCADA\n        zkjO9jHoDRfpJt8XgfsBS8FpANfHF2L29ntRwd8ocDwxXSbtBuGIkUSkOPUTx6i/\n        e9hd8vYh4mcX3yYpiW8Sui4aXbJu9uuSdU5KvPOaTsFeit9jBDK4b0baFYBDpcBB\n        rgQuyviMAVAczu5qlwolA/Vu6DWqah1X9p+4EFa1QitxkhYs3br2ZGy7FZA3f2sZ\n        aVhHAPAOBSuQ1W6tiUfTIj/Oc7N+FBjmh3VNfIvMBa0E3rA2JlObxUEywsgGo7FP\n        WnwjZyv883slHp/I3H4Or9VBouTWA2yICeROmMwjr4mOZtJTz9e4v/a2cG/mJXgx\n        Ce+FjBvTvrgOVHAXaNwLABEBAAG0IFphYmJpeCBMTEMgPHBhY2thZ2VyQHphYmJp\n        eC5jb20+iQE4BBMBAgAiBQJXiHb9AhsDBgsJCAcDAgYVCAIJCgsEFgIDAQIeAQIX\n        gAAKCRAIKrVroU/lkbO8B/4/MhxoUN2RPmH7BzFGIntKEWAwbRkDzyQOk9TjXVeg\n        fsBnzmDSdowh7gyteVauvr62jiVtowlE/95vbXqbBCISLqKGi9Wmbrj7lUXBd2sP\n        7eApFzMUhb3G3GuV5pCnRBIzerDfhXiLE9EWRN89JYDxwCLYctQHieZtdmlnPyCb\n        FF6wcXTHUEHBPqdTa6hvUqQL2lHLFoduqQz4Q47Cz7tZxnbrakAewEToPcjMoteC\n        SfXwF/BRxSUDlN7tKFfBpYQawS8ZtN09ImHOO6CZ/pA0qQimiNiRUfA25onIDWLL\n        Y/NMWg+gK94NVVZ7KmFG3upDB5/uefK6Xwu2PsgiXSQguQENBFeIdv0BCACZgfqg\n        z5YoX+ujVlw1gX1J+ygf10QsUM9GglLEuDiSS/Aa3C2UbgEa+N7JuvzZigGFCvxt\n        AzaerMMDzbliTqtMGJOTjWEVGxWQ3LiY6+NWgmV46AdXik7sUXM155f1vhOzYp6E\n        Zj/xtGvyUzTLUkAlnZNrhEUbUmOhDLassVi32hIyMR5W7w6IIi0zIM1mSuLR0H6o\n        DEpR3GzuGVHGj4/sLeAg7iY5MziGwySBQk0Dg0xH5YqHb+uKzCTH/ILu3srPJq+2\n        37Px/PctAZCEA96ogc/DNF2XjdUpMSaEybR0LuHHstAqkrq8AyRtDJNYE+09jDFd\n        UIukhErLuo1YPWqFABEBAAGJAR8EGAECAAkFAleIdv0CGwwACgkQCCq1a6FP5ZH8\n        +wf/erZneDXqM6xYT8qncFpc1GtOCeODNb19Ii22lDEXd9qNUlAz2SB6zC5oywln\n        R0o1cglcrW96MD/uuCL/+tTczeB2C455ofs2mhpK7nKiA4FM+JZZ6XSBnq7sfsYD\n        6knbvS//SXQV/qYb4bKMvwYnyMz63escgQhOsTT20ptc/w7fC+YPBR/rHImKspyI\n        wxyqU8EXylFW8f3Ugi2+Fna3CAPR9yQIAChkCjUawUa2VFmm5KP8DHg6oWM5mdqc\n        pvU5DMqpi8SA26DEFvULs8bR+kgDd5AU3I4+ei71GslOdfk4s1soKT4X2UK+dCCX\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\npackages:\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mssymbolsdata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /proxy-cache, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      proxy_cache_path /proxy-cache keys_zone=data:10m inactive=10000d;\n      client_max_body_size 200M;\n\n      resolver 8.8.8.8;\n\n      server {\n        listen 80 default_server;\n        server_name mssymbols.bad;\n\n        location / {\n          proxy_redirect off;\n          proxy_cache data;\n          proxy_cache_valid 200 404 406 10000d;\n          proxy_pass http://msdl.microsoft.com;\n          proxy_intercept_errors on;\n          error_page 301 302 307 = @handle_redirect;\n        }\n\n        location @handle_redirect {\n          set $saved_redirect_location '$upstream_http_location';\n          set $original_uri $uri;\n          set $orig_loc $upstream_http_location;\n          proxy_pass $orig_loc;\n          proxy_cache data;\n          proxy_cache_key $original_uri;\n          proxy_cache_valid 200 206 10000d;\n        }\n      }\n\nruncmd:\n  - mount /proxy-cache || true\n  - chmod -R 777 /proxy-cache\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname mssymbols\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: mssymbols\nfqdn: mssymbols.bad\n\r\n--MIMEBOUNDARY--\r\n"
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_cloudinit_config",
      "name": "mysql_cloud_init",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base64_encode": false,
            "gzip": false,
            "id": "3136126489",
            "part": [
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n",
                "content_type": "text/cloud-config",
                "filename": "base.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n",
                "content_type": "text/cloud-config",
                "filename": "zabbix_agent.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mysqldata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /var/lib/mysql, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - echo \"mariadb-server-10.0 mysql-server/root_password password Bad123\" | debconf-set-selections\n  - echo \"mariadb-server-10.0 mysql-server/root_password_again password Bad123\" | debconf-set-selections\n  - apt-get -y install mariadb-server\n  - sed -i -e \"s/^bind-address/#bind-address/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - sed -i -e \"s/^skip-networking/#skip-networking/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - mysql --user=\"root\" -e \"GRANT ALL ON *.* TO root@'%' IDENTIFIED BY 'Bad123' WITH GRANT OPTION;\"\n  - ufw default deny incoming\n  - ufw default allow outgoing\n  - ufw allow 3306/tcp\n  - echo \"y\" | ufw enable\n\n",
                "content_type": "text/cloud-config",
                "filename": "master.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname mysql\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: mysql\nfqdn: mysql.bad\n",
                "content_type": "text/cloud-config",
                "filename": "hostname.cfg",
                "merge_type": ""
              }
            ],
            "rendered": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mysqldata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /var/lib/mysql, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - echo \"mariadb-server-10.0 mysql-server/root_password password Bad123\" | debconf-set-selections\n  - echo \"mariadb-server-10.0 mysql-server/root_password_again password Bad123\" | debconf-set-selections\n  - apt-get -y install mariadb-server\n  - sed -i -e \"s/^bind-address/#bind-address/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - sed -i -e \"s/^skip-networking/#skip-networking/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - mysql --user=\"root\" -e \"GRANT ALL ON *.* TO root@'%' IDENTIFIED BY 'Bad123' WITH GRANT OPTION;\"\n  - ufw default deny incoming\n  - ufw default allow outgoing\n  - ufw allow 3306/tcp\n  - echo \"y\" | ufw enable\n\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname mysql\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: mysql\nfqdn: mysql.bad\n\r\n--MIMEBOUNDARY--\r\n"
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_cloudinit_config",
      "name": "zabbix_cloud_init",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base64_encode": false,
            "gzip": false,
            "id": "3081728165",
            "part": [
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n",
                "content_type": "text/cloud-config",
                "filename": "base.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n",
                "content_type": "text/cloud-config",
                "filename": "zabbix_agent.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nsystem_info:\n  apt_get_command: ['apt-get', '--option=Dpkg::Options::=--force-confold', '--option=Dpkg::options::=--force-unsafe-io', '--assume-yes', '--quiet', '--no-install-recommends']\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\nwrite_files:\n  - owner: root:root\n    path: /zabbix.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%',\n            'SET GLOBAL innodb_file_per_table = ON,\n                        innodb_file_format = Barracuda,\n                        innodb_large_prefix = ON;',\n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1;\n\n      --DROP DATABASE IF EXISTS zabbix;\n      CREATE DATABASE IF NOT EXISTS zabbix CHARACTER SET utf8 collate utf8_bin;\n      CREATE USER IF NOT EXISTS 'zabbix'@'%' IDENTIFIED BY 'ZabbixPasswordIsComplex123';\n      GRANT ALL ON zabbix.* TO zabbix@'%';\n      flush privileges;\n\n  - owner: www-data:www-data\n    path: /etc/zabbix/web/zabbix.conf.php\n    permissions: '0644'\n    content: |\n      \u003c?php\n      // Zabbix GUI configuration file.\n      global $DB;\n\n      $DB['TYPE']     = 'MYSQL';\n      $DB['SERVER']   = 'mysql.bad';\n      $DB['PORT']     = '0';\n      $DB['DATABASE'] = 'zabbix';\n      $DB['USER']     = 'zabbix';\n      $DB['PASSWORD'] = 'ZabbixPasswordIsComplex123';\n\n      // Schema name. Used for IBM DB2 and PostgreSQL.\n      $DB['SCHEMA'] = '';\n\n      $ZBX_SERVER      = 'localhost';\n      $ZBX_SERVER_PORT = '10051';\n      $ZBX_SERVER_NAME = '';\n\n      $IMAGE_FORMAT_DEFAULT = IMAGE_FORMAT_PNG;\n\npackages:\n  - zabbix-server-mysql\n  - zabbix-frontend-php\n  - zabbix-apache-conf\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -hmysql.bad -uroot -pBad123 \u003c /zabbix.sql\n  - 'zcat /usr/share/doc/zabbix-server-mysql/create.sql.gz | mysql -hmysql.bad -uzabbix -pZabbixPasswordIsComplex123 -Dzabbix'\n  - sed -i s'#\\# DBPassword=#DBPassword=ZabbixPasswordIsComplex123#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# DBHost=localhost#DBHost=mysql.bad#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# php_value date.timezone Europe/Riga#php_value date.timezone Europe/Samara#g' /etc/apache2/conf-enabled/zabbix.conf\n  - systemctl enable zabbix-server.service\n\n",
                "content_type": "text/cloud-config",
                "filename": "master.cfg",
                "merge_type": ""
              },
              {
                "content": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname zabbix\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: zabbix\nfqdn: zabbix.bad\n",
                "content_type": "text/cloud-config",
                "filename": "hostname.cfg",
                "merge_type": ""
              }
            ],
            "rendered": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nsystem_info:\n  apt_get_command: ['apt-get', '--option=Dpkg::Options::=--force-confold', '--option=Dpkg::options::=--force-unsafe-io', '--assume-yes', '--quiet', '--no-install-recommends']\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\nwrite_files:\n  - owner: root:root\n    path: /zabbix.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%',\n            'SET GLOBAL innodb_file_per_table = ON,\n                        innodb_file_format = Barracuda,\n                        innodb_large_prefix = ON;',\n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1;\n\n      --DROP DATABASE IF EXISTS zabbix;\n      CREATE DATABASE IF NOT EXISTS zabbix CHARACTER SET utf8 collate utf8_bin;\n      CREATE USER IF NOT EXISTS 'zabbix'@'%' IDENTIFIED BY 'ZabbixPasswordIsComplex123';\n      GRANT ALL ON zabbix.* TO zabbix@'%';\n      flush privileges;\n\n  - owner: www-data:www-data\n    path: /etc/zabbix/web/zabbix.conf.php\n    permissions: '0644'\n    content: |\n      \u003c?php\n      // Zabbix GUI configuration file.\n      global $DB;\n\n      $DB['TYPE']     = 'MYSQL';\n      $DB['SERVER']   = 'mysql.bad';\n      $DB['PORT']     = '0';\n      $DB['DATABASE'] = 'zabbix';\n      $DB['USER']     = 'zabbix';\n      $DB['PASSWORD'] = 'ZabbixPasswordIsComplex123';\n\n      // Schema name. Used for IBM DB2 and PostgreSQL.\n      $DB['SCHEMA'] = '';\n\n      $ZBX_SERVER      = 'localhost';\n      $ZBX_SERVER_PORT = '10051';\n      $ZBX_SERVER_NAME = '';\n\n      $IMAGE_FORMAT_DEFAULT = IMAGE_FORMAT_PNG;\n\npackages:\n  - zabbix-server-mysql\n  - zabbix-frontend-php\n  - zabbix-apache-conf\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -hmysql.bad -uroot -pBad123 \u003c /zabbix.sql\n  - 'zcat /usr/share/doc/zabbix-server-mysql/create.sql.gz | mysql -hmysql.bad -uzabbix -pZabbixPasswordIsComplex123 -Dzabbix'\n  - sed -i s'#\\# DBPassword=#DBPassword=ZabbixPasswordIsComplex123#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# DBHost=localhost#DBHost=mysql.bad#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# php_value date.timezone Europe/Riga#php_value date.timezone Europe/Samara#g' /etc/apache2/conf-enabled/zabbix.conf\n  - systemctl enable zabbix-server.service\n\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname zabbix\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: zabbix\nfqdn: zabbix.bad\n\r\n--MIMEBOUNDARY--\r\n"
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_base",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "551bf18b53a98fe1d933243b0e6931f8e5ab16c4b056bd150db1670955ad49db",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_dev",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "121acbdf82fd30f2476207a31c02873dc1642ef68fb9d43485903e3646b626ba",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_dev_hostname",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "4bee28f938e89493a07df172aaf2a609802f253e92e015369786ce40d3bdfb28",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname dev\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: dev\nfqdn: dev.bad\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname ${tf_hostname}\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: ${tf_hostname}\nfqdn: ${tf_hostname}.bad\n",
            "vars": {
              "tf_hostname": "dev"
            }
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_gitea",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "1d9d99431744aaf5c11c803830b9f05ea9a10d3e3c2d6057ac65f2b8243e9a6e",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: git\n    shell: /sbin/nologin\n    lock_passwd: true\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\n\npackages:\n  - mysql-client\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: giteadata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /gitea, auto, \"defaults\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      server {\n        listen          80;\n        server_name     gitea.bad;\n        location / {\n          proxy_pass      http://localhost:3000;\n        }\n      }\n\n  - owner: root:root\n    path: /gitea.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%', \n            'SET GLOBAL innodb_file_per_table = ON, \n                        innodb_file_format = Barracuda, \n                        innodb_large_prefix = ON,\n                        innodb_default_row_format = dynamic;', \n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1; \n\n      CREATE DATABASE IF NOT EXISTS gitea CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;\n      CREATE USER IF NOT EXISTS 'gitea'@'%' IDENTIFIED BY 'GiteaPasswordIsComplex123';\n      GRANT ALL ON gitea.* TO gitea@'%';\n      flush privileges;\n\n  - owner: root:root\n    path: /etc/gitea/app.ini\n    content: |\n      APP_NAME = Gitea: Git with a cup of tea\n      RUN_USER = git\n      RUN_MODE = prod\n\n      [oauth2]\n      JWT_SECRET = rhjIEqkeVoGfg_eAeFhl2CMNvyogLaiGJ65T-r3m8Tg\n\n      [security]\n      INTERNAL_TOKEN = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYmYiOjE1ODIzMjQ3Mzh9.SxIK4tJRlCFMZ3gxqL0w-2sZI1yT5R3HB9RyTGeLHd4\n      INSTALL_LOCK   = true\n      SECRET_KEY     = 1V2L7Ff2YBU6cVbrr1uXX8W0c47c4EleyzdGTPR80ZUeczDeYt9K3TvZBFbyALBG\n\n      [database]\n      DB_TYPE  = mysql\n      HOST     = mysql.bad:3306\n      NAME     = gitea\n      USER     = gitea\n      PASSWD   = GiteaPasswordIsComplex123\n      SSL_MODE = disable\n      CHARSET  = utf8mb4\n      PATH     = /gitea/data/gitea.db\n\n      [repository]\n      ROOT = /gitea/git-repo/\n\n      [server]\n      SSH_DOMAIN       = gitea.bad\n      DOMAIN           = gitea.bad\n      HTTP_PORT        = 3000\n      ROOT_URL         = http://gitea.bad/\n      DISABLE_SSH      = false\n      START_SSH_SERVER = true\n      SSH_PORT         = 22\n      LFS_START_SERVER = true\n      LFS_CONTENT_PATH = /gitea/git-lfs/\n      LFS_JWT_SECRET   = V81hY-fG_5u8CensrkUMfX_0C4ag8tU5lVHQeEITQPs\n      OFFLINE_MODE     = true\n\n      [mailer]\n      ENABLED = false\n\n      [service]\n      REGISTER_EMAIL_CONFIRM            = false\n      ENABLE_NOTIFY_MAIL                = false\n      DISABLE_REGISTRATION              = false\n      ALLOW_ONLY_EXTERNAL_REGISTRATION  = false\n      ENABLE_CAPTCHA                    = false\n      REQUIRE_SIGNIN_VIEW               = false\n      DEFAULT_KEEP_EMAIL_PRIVATE        = false\n      DEFAULT_ALLOW_CREATE_ORGANIZATION = true\n      DEFAULT_ENABLE_TIMETRACKING       = true\n      NO_REPLY_ADDRESS                  = noreply.localhost\n\n      [picture]\n      DISABLE_GRAVATAR        = true\n      ENABLE_FEDERATED_AVATAR = false\n\n      [openid]\n      ENABLE_OPENID_SIGNIN = false\n      ENABLE_OPENID_SIGNUP = false\n\n      [session]\n      PROVIDER = file\n\n      [log]\n      MODE      = file\n      LEVEL     = info\n      ROOT_PATH = /gitea/log/\n\n\n  - owner: root:root\n    path: /etc/systemd/system/gitea.service\n    content: |\n      [Unit]\n      Description=Gitea (Git with a cup of tea)\n      After=syslog.target\n      After=network.target\n\n      [Service]\n      RestartSec=2s\n      Type=simple\n      User=git\n      Group=git\n      WorkingDirectory=/gitea/\n      ExecStart=/usr/local/bin/gitea web -c /etc/gitea/app.ini\n      Restart=always\n      Environment=USER=git HOME=/home/git GITEA_WORK_DIR=/gitea\n      AmbientCapabilities=CAP_NET_BIND_SERVICE\n      CapabilityBoundingSet=CAP_NET_BIND_SERVICE\n      PrivateUsers=false\n\n      [Install]\n      WantedBy=multi-user.target\n\nruncmd:\n  - systemctl disable ssh\n  - service ssh stop\n  - service nginx restart\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -h mysql.bad -uroot -pBad123 \u003c /gitea.sql\n  - mount /gitea || true\n  - wget https://dl.gitea.io/gitea/1.11.1/gitea-1.11.1-linux-amd64 -P/tmp\n  - mv /tmp/gitea-1.11.1-linux-amd64 /usr/local/bin/gitea\n  - sudo chmod +x /usr/local/bin/gitea\n  - mkdir -p /gitea/custom\n  - mkdir -p /gitea/data\n  - mkdir -p /gitea/log\n  - chown -R git:git /gitea/\n  - chmod -R 750 /gitea/\n  - mkdir /etc/gitea\n  - chown root:git /etc/gitea\n  - chmod 770 /etc/gitea\n  - systemctl daemon-reload\n  - systemctl enable gitea\n  - systemctl start gitea\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: git\n    shell: /sbin/nologin\n    lock_passwd: true\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\n\npackages:\n  - mysql-client\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: giteadata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /gitea, auto, \"defaults\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      server {\n        listen          80;\n        server_name     gitea.bad;\n        location / {\n          proxy_pass      http://localhost:3000;\n        }\n      }\n\n  - owner: root:root\n    path: /gitea.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%', \n            'SET GLOBAL innodb_file_per_table = ON, \n                        innodb_file_format = Barracuda, \n                        innodb_large_prefix = ON,\n                        innodb_default_row_format = dynamic;', \n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1; \n\n      CREATE DATABASE IF NOT EXISTS gitea CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;\n      CREATE USER IF NOT EXISTS 'gitea'@'%' IDENTIFIED BY 'GiteaPasswordIsComplex123';\n      GRANT ALL ON gitea.* TO gitea@'%';\n      flush privileges;\n\n  - owner: root:root\n    path: /etc/gitea/app.ini\n    content: |\n      APP_NAME = Gitea: Git with a cup of tea\n      RUN_USER = git\n      RUN_MODE = prod\n\n      [oauth2]\n      JWT_SECRET = rhjIEqkeVoGfg_eAeFhl2CMNvyogLaiGJ65T-r3m8Tg\n\n      [security]\n      INTERNAL_TOKEN = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYmYiOjE1ODIzMjQ3Mzh9.SxIK4tJRlCFMZ3gxqL0w-2sZI1yT5R3HB9RyTGeLHd4\n      INSTALL_LOCK   = true\n      SECRET_KEY     = 1V2L7Ff2YBU6cVbrr1uXX8W0c47c4EleyzdGTPR80ZUeczDeYt9K3TvZBFbyALBG\n\n      [database]\n      DB_TYPE  = mysql\n      HOST     = mysql.bad:3306\n      NAME     = gitea\n      USER     = gitea\n      PASSWD   = GiteaPasswordIsComplex123\n      SSL_MODE = disable\n      CHARSET  = utf8mb4\n      PATH     = /gitea/data/gitea.db\n\n      [repository]\n      ROOT = /gitea/git-repo/\n\n      [server]\n      SSH_DOMAIN       = gitea.bad\n      DOMAIN           = gitea.bad\n      HTTP_PORT        = 3000\n      ROOT_URL         = http://gitea.bad/\n      DISABLE_SSH      = false\n      START_SSH_SERVER = true\n      SSH_PORT         = 22\n      LFS_START_SERVER = true\n      LFS_CONTENT_PATH = /gitea/git-lfs/\n      LFS_JWT_SECRET   = V81hY-fG_5u8CensrkUMfX_0C4ag8tU5lVHQeEITQPs\n      OFFLINE_MODE     = true\n\n      [mailer]\n      ENABLED = false\n\n      [service]\n      REGISTER_EMAIL_CONFIRM            = false\n      ENABLE_NOTIFY_MAIL                = false\n      DISABLE_REGISTRATION              = false\n      ALLOW_ONLY_EXTERNAL_REGISTRATION  = false\n      ENABLE_CAPTCHA                    = false\n      REQUIRE_SIGNIN_VIEW               = false\n      DEFAULT_KEEP_EMAIL_PRIVATE        = false\n      DEFAULT_ALLOW_CREATE_ORGANIZATION = true\n      DEFAULT_ENABLE_TIMETRACKING       = true\n      NO_REPLY_ADDRESS                  = noreply.localhost\n\n      [picture]\n      DISABLE_GRAVATAR        = true\n      ENABLE_FEDERATED_AVATAR = false\n\n      [openid]\n      ENABLE_OPENID_SIGNIN = false\n      ENABLE_OPENID_SIGNUP = false\n\n      [session]\n      PROVIDER = file\n\n      [log]\n      MODE      = file\n      LEVEL     = info\n      ROOT_PATH = /gitea/log/\n\n\n  - owner: root:root\n    path: /etc/systemd/system/gitea.service\n    content: |\n      [Unit]\n      Description=Gitea (Git with a cup of tea)\n      After=syslog.target\n      After=network.target\n\n      [Service]\n      RestartSec=2s\n      Type=simple\n      User=git\n      Group=git\n      WorkingDirectory=/gitea/\n      ExecStart=/usr/local/bin/gitea web -c /etc/gitea/app.ini\n      Restart=always\n      Environment=USER=git HOME=/home/git GITEA_WORK_DIR=/gitea\n      AmbientCapabilities=CAP_NET_BIND_SERVICE\n      CapabilityBoundingSet=CAP_NET_BIND_SERVICE\n      PrivateUsers=false\n\n      [Install]\n      WantedBy=multi-user.target\n\nruncmd:\n  - systemctl disable ssh\n  - service ssh stop\n  - service nginx restart\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -h mysql.bad -uroot -pBad123 \u003c /gitea.sql\n  - mount /gitea || true\n  - wget https://dl.gitea.io/gitea/1.11.1/gitea-1.11.1-linux-amd64 -P/tmp\n  - mv /tmp/gitea-1.11.1-linux-amd64 /usr/local/bin/gitea\n  - sudo chmod +x /usr/local/bin/gitea\n  - mkdir -p /gitea/custom\n  - mkdir -p /gitea/data\n  - mkdir -p /gitea/log\n  - chown -R git:git /gitea/\n  - chmod -R 750 /gitea/\n  - mkdir /etc/gitea\n  - chown root:git /etc/gitea\n  - chmod 770 /etc/gitea\n  - systemctl daemon-reload\n  - systemctl enable gitea\n  - systemctl start gitea\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_gitea_hostname",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "6a683d25b9c30a96ed2868949be761eaeef5b526e2a8baec90f8edced27389a5",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname gitea\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: gitea\nfqdn: gitea.bad\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname ${tf_hostname}\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: ${tf_hostname}\nfqdn: ${tf_hostname}.bad\n",
            "vars": {
              "tf_hostname": "gitea"
            }
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_minio",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "a6ec0c064318bb917dc4770e9c6532319280bb85f801b3c046bdea0cc160e81e",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: minio-user\n    shell: /sbin/nologin\n    lock_passwd: true\n\nssh_pwauth: True\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: miniodata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /minio, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nwrite_files:\n  - owner: root:root\n    path: /etc/default/minio\n    content: |\n      MINIO_VOLUMES=/minio\n      MINIO_OPTS=\"-C /etc/minio --address :80\"\n      MINIO_ACCESS_KEY=bad\n      MINIO_SECRET_KEY=Bad12345\n\n  - owner: root:root\n    path: /etc/systemd/system/minio.service\n    content: |\n      [Unit]\n      Description=MinIO\n      Documentation=https://docs.min.io\n      Wants=network-online.target\n      After=network-online.target\n      AssertFileIsExecutable=/usr/local/bin/minio\n\n      [Service]\n      WorkingDirectory=/usr/local/\n\n      User=minio-user\n      Group=minio-user\n\n      EnvironmentFile=/etc/default/minio\n      ExecStartPre=/bin/bash -c \"if [ -z \\\"${MINIO_VOLUMES}\\\" ]; then echo \\\"Variable MINIO_VOLUMES not set in /etc/default/minio\\\"; exit 1; fi\"\n\n      ExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES\n\n      # Let systemd restart this service always\n      Restart=always\n\n      # Specifies the maximum file descriptor number that can be opened by this process\n      LimitNOFILE=65536\n\n      # Disable timeout logic and wait until process is stopped\n      TimeoutStopSec=infinity\n      SendSIGKILL=no\n\n      [Install]\n      WantedBy=multi-user.target\n\n      # Built for ${project.name}-${project.version} (${project.name})\n\nruncmd:\n  - chown minio-user /minio\n  - chmod u+rxw /minio\n  - wget https://dl.minio.io/server/minio/release/linux-amd64/minio -P/tmp/\n  - wget https://dl.min.io/client/mc/release/linux-amd64/mc -P/tmp/\n  - chmod +x /tmp/minio\n  - chmod +x /tmp/mc\n  - mv /tmp/minio /usr/local/bin\n  - setcap cap_net_bind_service=+ep /usr/local/bin/minio\n  - mv /tmp/mc /usr/local/bin\n  - systemctl daemon-reload\n  - systemctl enable minio\n  - systemctl start minio\n  - mc config host add home http://localhost:80 bad Bad12345 --api \"s3v4\" --lookup \"dns\"\n  - mc admin user add home crash Crash12345\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: minio-user\n    shell: /sbin/nologin\n    lock_passwd: true\n\nssh_pwauth: True\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: miniodata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /minio, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nwrite_files:\n  - owner: root:root\n    path: /etc/default/minio\n    content: |\n      MINIO_VOLUMES=/minio\n      MINIO_OPTS=\"-C /etc/minio --address :80\"\n      MINIO_ACCESS_KEY=bad\n      MINIO_SECRET_KEY=Bad12345\n\n  - owner: root:root\n    path: /etc/systemd/system/minio.service\n    content: |\n      [Unit]\n      Description=MinIO\n      Documentation=https://docs.min.io\n      Wants=network-online.target\n      After=network-online.target\n      AssertFileIsExecutable=/usr/local/bin/minio\n\n      [Service]\n      WorkingDirectory=/usr/local/\n\n      User=minio-user\n      Group=minio-user\n\n      EnvironmentFile=/etc/default/minio\n      ExecStartPre=/bin/bash -c \"if [ -z \\\"$${MINIO_VOLUMES}\\\" ]; then echo \\\"Variable MINIO_VOLUMES not set in /etc/default/minio\\\"; exit 1; fi\"\n\n      ExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES\n\n      # Let systemd restart this service always\n      Restart=always\n\n      # Specifies the maximum file descriptor number that can be opened by this process\n      LimitNOFILE=65536\n\n      # Disable timeout logic and wait until process is stopped\n      TimeoutStopSec=infinity\n      SendSIGKILL=no\n\n      [Install]\n      WantedBy=multi-user.target\n\n      # Built for $${project.name}-$${project.version} ($${project.name})\n\nruncmd:\n  - chown minio-user /minio\n  - chmod u+rxw /minio\n  - wget https://dl.minio.io/server/minio/release/linux-amd64/minio -P/tmp/\n  - wget https://dl.min.io/client/mc/release/linux-amd64/mc -P/tmp/\n  - chmod +x /tmp/minio\n  - chmod +x /tmp/mc\n  - mv /tmp/minio /usr/local/bin\n  - setcap cap_net_bind_service=+ep /usr/local/bin/minio\n  - mv /tmp/mc /usr/local/bin\n  - systemctl daemon-reload\n  - systemctl enable minio\n  - systemctl start minio\n  - mc config host add home http://localhost:80 bad Bad12345 --api \"s3v4\" --lookup \"dns\"\n  - mc admin user add home crash Crash12345\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_minio_hostname",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "5c81a3375e2e1920e04c58a8d82943b5366ff4ad0cff76f279f8f3451594ca5e",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname minio\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: minio\nfqdn: minio.bad\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname ${tf_hostname}\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: ${tf_hostname}\nfqdn: ${tf_hostname}.bad\n",
            "vars": {
              "tf_hostname": "minio"
            }
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_mssymbols",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "b92e5f91ebd98719fe74708f368051dac47690cac5ad65159afb3eee0eb8c968",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\npackages:\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mssymbolsdata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /proxy-cache, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      proxy_cache_path /proxy-cache keys_zone=data:10m inactive=10000d;\n      client_max_body_size 200M;\n\n      resolver 8.8.8.8;\n\n      server {\n        listen 80 default_server;\n        server_name mssymbols.bad;\n\n        location / {\n          proxy_redirect off;\n          proxy_cache data;\n          proxy_cache_valid 200 404 406 10000d;\n          proxy_pass http://msdl.microsoft.com;\n          proxy_intercept_errors on;\n          error_page 301 302 307 = @handle_redirect;\n        }\n\n        location @handle_redirect {\n          set $saved_redirect_location '$upstream_http_location';\n          set $original_uri $uri;\n          set $orig_loc $upstream_http_location;\n          proxy_pass $orig_loc;\n          proxy_cache data;\n          proxy_cache_key $original_uri;\n          proxy_cache_valid 200 206 10000d;\n        }\n      }\n\nruncmd:\n  - mount /proxy-cache || true\n  - chmod -R 777 /proxy-cache\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\npackages:\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mssymbolsdata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /proxy-cache, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      proxy_cache_path /proxy-cache keys_zone=data:10m inactive=10000d;\n      client_max_body_size 200M;\n\n      resolver 8.8.8.8;\n\n      server {\n        listen 80 default_server;\n        server_name mssymbols.bad;\n\n        location / {\n          proxy_redirect off;\n          proxy_cache data;\n          proxy_cache_valid 200 404 406 10000d;\n          proxy_pass http://msdl.microsoft.com;\n          proxy_intercept_errors on;\n          error_page 301 302 307 = @handle_redirect;\n        }\n\n        location @handle_redirect {\n          set $saved_redirect_location '$upstream_http_location';\n          set $original_uri $uri;\n          set $orig_loc $upstream_http_location;\n          proxy_pass $orig_loc;\n          proxy_cache data;\n          proxy_cache_key $original_uri;\n          proxy_cache_valid 200 206 10000d;\n        }\n      }\n\nruncmd:\n  - mount /proxy-cache || true\n  - chmod -R 777 /proxy-cache\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_mssymbols_hostname",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "33cdbfe6c5726776e90764619bdd6f87c0b05c7e6f871723fff745f819cde608",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname mssymbols\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: mssymbols\nfqdn: mssymbols.bad\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname ${tf_hostname}\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: ${tf_hostname}\nfqdn: ${tf_hostname}.bad\n",
            "vars": {
              "tf_hostname": "mssymbols"
            }
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_mysql",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "e4472313ea2651c9b6bc3d6c9aa34c8e95f14d83fd07ffe603af7340ed7b1e5e",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mysqldata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /var/lib/mysql, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - echo \"mariadb-server-10.0 mysql-server/root_password password Bad123\" | debconf-set-selections\n  - echo \"mariadb-server-10.0 mysql-server/root_password_again password Bad123\" | debconf-set-selections\n  - apt-get -y install mariadb-server\n  - sed -i -e \"s/^bind-address/#bind-address/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - sed -i -e \"s/^skip-networking/#skip-networking/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - mysql --user=\"root\" -e \"GRANT ALL ON *.* TO root@'%' IDENTIFIED BY 'Bad123' WITH GRANT OPTION;\"\n  - ufw default deny incoming\n  - ufw default allow outgoing\n  - ufw allow 3306/tcp\n  - echo \"y\" | ufw enable\n\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mysqldata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /var/lib/mysql, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - echo \"mariadb-server-10.0 mysql-server/root_password password Bad123\" | debconf-set-selections\n  - echo \"mariadb-server-10.0 mysql-server/root_password_again password Bad123\" | debconf-set-selections\n  - apt-get -y install mariadb-server\n  - sed -i -e \"s/^bind-address/#bind-address/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - sed -i -e \"s/^skip-networking/#skip-networking/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - mysql --user=\"root\" -e \"GRANT ALL ON *.* TO root@'%' IDENTIFIED BY 'Bad123' WITH GRANT OPTION;\"\n  - ufw default deny incoming\n  - ufw default allow outgoing\n  - ufw allow 3306/tcp\n  - echo \"y\" | ufw enable\n\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_mysql_hostname",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "0d55816764f3dc860d5b4bb4ecc84631453dbd1d51ac75d7dba6ea04058490f4",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname mysql\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: mysql\nfqdn: mysql.bad\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname ${tf_hostname}\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: ${tf_hostname}\nfqdn: ${tf_hostname}.bad\n",
            "vars": {
              "tf_hostname": "mysql"
            }
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_zabbix",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "ac760aa44f6319ad6ef23315ae68b1a84c41d5c646beeeeebe743ac34d05c9c9",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nsystem_info:\n  apt_get_command: ['apt-get', '--option=Dpkg::Options::=--force-confold', '--option=Dpkg::options::=--force-unsafe-io', '--assume-yes', '--quiet', '--no-install-recommends']\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\nwrite_files:\n  - owner: root:root\n    path: /zabbix.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%',\n            'SET GLOBAL innodb_file_per_table = ON,\n                        innodb_file_format = Barracuda,\n                        innodb_large_prefix = ON;',\n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1;\n\n      --DROP DATABASE IF EXISTS zabbix;\n      CREATE DATABASE IF NOT EXISTS zabbix CHARACTER SET utf8 collate utf8_bin;\n      CREATE USER IF NOT EXISTS 'zabbix'@'%' IDENTIFIED BY 'ZabbixPasswordIsComplex123';\n      GRANT ALL ON zabbix.* TO zabbix@'%';\n      flush privileges;\n\n  - owner: www-data:www-data\n    path: /etc/zabbix/web/zabbix.conf.php\n    permissions: '0644'\n    content: |\n      \u003c?php\n      // Zabbix GUI configuration file.\n      global $DB;\n\n      $DB['TYPE']     = 'MYSQL';\n      $DB['SERVER']   = 'mysql.bad';\n      $DB['PORT']     = '0';\n      $DB['DATABASE'] = 'zabbix';\n      $DB['USER']     = 'zabbix';\n      $DB['PASSWORD'] = 'ZabbixPasswordIsComplex123';\n\n      // Schema name. Used for IBM DB2 and PostgreSQL.\n      $DB['SCHEMA'] = '';\n\n      $ZBX_SERVER      = 'localhost';\n      $ZBX_SERVER_PORT = '10051';\n      $ZBX_SERVER_NAME = '';\n\n      $IMAGE_FORMAT_DEFAULT = IMAGE_FORMAT_PNG;\n\npackages:\n  - zabbix-server-mysql\n  - zabbix-frontend-php\n  - zabbix-apache-conf\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -hmysql.bad -uroot -pBad123 \u003c /zabbix.sql\n  - 'zcat /usr/share/doc/zabbix-server-mysql/create.sql.gz | mysql -hmysql.bad -uzabbix -pZabbixPasswordIsComplex123 -Dzabbix'\n  - sed -i s'#\\# DBPassword=#DBPassword=ZabbixPasswordIsComplex123#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# DBHost=localhost#DBHost=mysql.bad#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# php_value date.timezone Europe/Riga#php_value date.timezone Europe/Samara#g' /etc/apache2/conf-enabled/zabbix.conf\n  - systemctl enable zabbix-server.service\n\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nsystem_info:\n  apt_get_command: ['apt-get', '--option=Dpkg::Options::=--force-confold', '--option=Dpkg::options::=--force-unsafe-io', '--assume-yes', '--quiet', '--no-install-recommends']\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\nwrite_files:\n  - owner: root:root\n    path: /zabbix.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%',\n            'SET GLOBAL innodb_file_per_table = ON,\n                        innodb_file_format = Barracuda,\n                        innodb_large_prefix = ON;',\n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1;\n\n      --DROP DATABASE IF EXISTS zabbix;\n      CREATE DATABASE IF NOT EXISTS zabbix CHARACTER SET utf8 collate utf8_bin;\n      CREATE USER IF NOT EXISTS 'zabbix'@'%' IDENTIFIED BY 'ZabbixPasswordIsComplex123';\n      GRANT ALL ON zabbix.* TO zabbix@'%';\n      flush privileges;\n\n  - owner: www-data:www-data\n    path: /etc/zabbix/web/zabbix.conf.php\n    permissions: '0644'\n    content: |\n      \u003c?php\n      // Zabbix GUI configuration file.\n      global $DB;\n\n      $DB['TYPE']     = 'MYSQL';\n      $DB['SERVER']   = 'mysql.bad';\n      $DB['PORT']     = '0';\n      $DB['DATABASE'] = 'zabbix';\n      $DB['USER']     = 'zabbix';\n      $DB['PASSWORD'] = 'ZabbixPasswordIsComplex123';\n\n      // Schema name. Used for IBM DB2 and PostgreSQL.\n      $DB['SCHEMA'] = '';\n\n      $ZBX_SERVER      = 'localhost';\n      $ZBX_SERVER_PORT = '10051';\n      $ZBX_SERVER_NAME = '';\n\n      $IMAGE_FORMAT_DEFAULT = IMAGE_FORMAT_PNG;\n\npackages:\n  - zabbix-server-mysql\n  - zabbix-frontend-php\n  - zabbix-apache-conf\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -hmysql.bad -uroot -pBad123 \u003c /zabbix.sql\n  - 'zcat /usr/share/doc/zabbix-server-mysql/create.sql.gz | mysql -hmysql.bad -uzabbix -pZabbixPasswordIsComplex123 -Dzabbix'\n  - sed -i s'#\\# DBPassword=#DBPassword=ZabbixPasswordIsComplex123#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# DBHost=localhost#DBHost=mysql.bad#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# php_value date.timezone Europe/Riga#php_value date.timezone Europe/Samara#g' /etc/apache2/conf-enabled/zabbix.conf\n  - systemctl enable zabbix-server.service\n\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_zabbix_agent",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "4f515a816361dc4fa5e981bf368aa3ae71d2198defd9a0be0d2889594ba91f9c",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "cloud_init_zabbix_hostname",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "eeec00d1740bb1ef1b815d9d65749c3b631e98c350e6cb5ece246ecee2d984e7",
            "rendered": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname zabbix\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: zabbix\nfqdn: zabbix.bad\n",
            "template": "#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname ${tf_hostname}\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: ${tf_hostname}\nfqdn: ${tf_hostname}.bad\n",
            "vars": {
              "tf_hostname": "zabbix"
            }
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "network_config",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "b36a1372ce4ea68b514354202c26c0365df9a17f25cd5acdeeaea525cd913edc",
            "rendered": "version: 2\nethernets:\n  ens3:\n    dhcp4: true\n",
            "template": "version: 2\nethernets:\n  ens3:\n    dhcp4: true\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_cloudinit_disk",
      "name": "dev_commoninit",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/raid/terraform/libvirt-pool-home/dev_commoninit.iso;5f1b53f6-c88d-2af7-10e2-ba86b36da69a",
            "meta_data": "",
            "name": "dev_commoninit.iso",
            "network_config": "version: 2\nethernets:\n  ens3:\n    dhcp4: true\n",
            "pool": "home",
            "user_data": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname dev\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: dev\nfqdn: dev.bad\n\r\n--MIMEBOUNDARY--\r\n"
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_cloudinit_disk",
      "name": "gitea_commoninit",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/raid/terraform/libvirt-pool-home/gitea_commoninit.iso;5f1b53fc-0c03-642b-b8a3-b5460100b3e2",
            "meta_data": "",
            "name": "gitea_commoninit.iso",
            "network_config": "version: 2\nethernets:\n  ens3:\n    dhcp4: true\n",
            "pool": "home",
            "user_data": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: git\n    shell: /sbin/nologin\n    lock_passwd: true\n  - name: bad\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock_passwd: false\n    passwd: $1$qNbb.TvD$7RpYxVpgrgTQnQA6MrZYs1\n\nssh_pwauth: True\n\n\npackages:\n  - mysql-client\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: giteadata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /gitea, auto, \"defaults\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      server {\n        listen          80;\n        server_name     gitea.bad;\n        location / {\n          proxy_pass      http://localhost:3000;\n        }\n      }\n\n  - owner: root:root\n    path: /gitea.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%', \n            'SET GLOBAL innodb_file_per_table = ON, \n                        innodb_file_format = Barracuda, \n                        innodb_large_prefix = ON,\n                        innodb_default_row_format = dynamic;', \n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1; \n\n      CREATE DATABASE IF NOT EXISTS gitea CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;\n      CREATE USER IF NOT EXISTS 'gitea'@'%' IDENTIFIED BY 'GiteaPasswordIsComplex123';\n      GRANT ALL ON gitea.* TO gitea@'%';\n      flush privileges;\n\n  - owner: root:root\n    path: /etc/gitea/app.ini\n    content: |\n      APP_NAME = Gitea: Git with a cup of tea\n      RUN_USER = git\n      RUN_MODE = prod\n\n      [oauth2]\n      JWT_SECRET = rhjIEqkeVoGfg_eAeFhl2CMNvyogLaiGJ65T-r3m8Tg\n\n      [security]\n      INTERNAL_TOKEN = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYmYiOjE1ODIzMjQ3Mzh9.SxIK4tJRlCFMZ3gxqL0w-2sZI1yT5R3HB9RyTGeLHd4\n      INSTALL_LOCK   = true\n      SECRET_KEY     = 1V2L7Ff2YBU6cVbrr1uXX8W0c47c4EleyzdGTPR80ZUeczDeYt9K3TvZBFbyALBG\n\n      [database]\n      DB_TYPE  = mysql\n      HOST     = mysql.bad:3306\n      NAME     = gitea\n      USER     = gitea\n      PASSWD   = GiteaPasswordIsComplex123\n      SSL_MODE = disable\n      CHARSET  = utf8mb4\n      PATH     = /gitea/data/gitea.db\n\n      [repository]\n      ROOT = /gitea/git-repo/\n\n      [server]\n      SSH_DOMAIN       = gitea.bad\n      DOMAIN           = gitea.bad\n      HTTP_PORT        = 3000\n      ROOT_URL         = http://gitea.bad/\n      DISABLE_SSH      = false\n      START_SSH_SERVER = true\n      SSH_PORT         = 22\n      LFS_START_SERVER = true\n      LFS_CONTENT_PATH = /gitea/git-lfs/\n      LFS_JWT_SECRET   = V81hY-fG_5u8CensrkUMfX_0C4ag8tU5lVHQeEITQPs\n      OFFLINE_MODE     = true\n\n      [mailer]\n      ENABLED = false\n\n      [service]\n      REGISTER_EMAIL_CONFIRM            = false\n      ENABLE_NOTIFY_MAIL                = false\n      DISABLE_REGISTRATION              = false\n      ALLOW_ONLY_EXTERNAL_REGISTRATION  = false\n      ENABLE_CAPTCHA                    = false\n      REQUIRE_SIGNIN_VIEW               = false\n      DEFAULT_KEEP_EMAIL_PRIVATE        = false\n      DEFAULT_ALLOW_CREATE_ORGANIZATION = true\n      DEFAULT_ENABLE_TIMETRACKING       = true\n      NO_REPLY_ADDRESS                  = noreply.localhost\n\n      [picture]\n      DISABLE_GRAVATAR        = true\n      ENABLE_FEDERATED_AVATAR = false\n\n      [openid]\n      ENABLE_OPENID_SIGNIN = false\n      ENABLE_OPENID_SIGNUP = false\n\n      [session]\n      PROVIDER = file\n\n      [log]\n      MODE      = file\n      LEVEL     = info\n      ROOT_PATH = /gitea/log/\n\n\n  - owner: root:root\n    path: /etc/systemd/system/gitea.service\n    content: |\n      [Unit]\n      Description=Gitea (Git with a cup of tea)\n      After=syslog.target\n      After=network.target\n\n      [Service]\n      RestartSec=2s\n      Type=simple\n      User=git\n      Group=git\n      WorkingDirectory=/gitea/\n      ExecStart=/usr/local/bin/gitea web -c /etc/gitea/app.ini\n      Restart=always\n      Environment=USER=git HOME=/home/git GITEA_WORK_DIR=/gitea\n      AmbientCapabilities=CAP_NET_BIND_SERVICE\n      CapabilityBoundingSet=CAP_NET_BIND_SERVICE\n      PrivateUsers=false\n\n      [Install]\n      WantedBy=multi-user.target\n\nruncmd:\n  - systemctl disable ssh\n  - service ssh stop\n  - service nginx restart\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -h mysql.bad -uroot -pBad123 \u003c /gitea.sql\n  - mount /gitea || true\n  - wget https://dl.gitea.io/gitea/1.11.1/gitea-1.11.1-linux-amd64 -P/tmp\n  - mv /tmp/gitea-1.11.1-linux-amd64 /usr/local/bin/gitea\n  - sudo chmod +x /usr/local/bin/gitea\n  - mkdir -p /gitea/custom\n  - mkdir -p /gitea/data\n  - mkdir -p /gitea/log\n  - chown -R git:git /gitea/\n  - chmod -R 750 /gitea/\n  - mkdir /etc/gitea\n  - chown root:git /etc/gitea\n  - chmod 770 /etc/gitea\n  - systemctl daemon-reload\n  - systemctl enable gitea\n  - systemctl start gitea\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname gitea\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: gitea\nfqdn: gitea.bad\n\r\n--MIMEBOUNDARY--\r\n"
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_cloudinit_disk",
      "name": "minio_commoninit",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/raid/terraform/libvirt-pool-home/minio_commoninit.iso;5f1b53f6-df43-e8d0-562f-69a0a7652d87",
            "meta_data": "",
            "name": "minio_commoninit.iso",
            "network_config": "version: 2\nethernets:\n  ens3:\n    dhcp4: true\n",
            "pool": "home",
            "user_data": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nusers:\n  - name: minio-user\n    shell: /sbin/nologin\n    lock_passwd: true\n\nssh_pwauth: True\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: miniodata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /minio, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nwrite_files:\n  - owner: root:root\n    path: /etc/default/minio\n    content: |\n      MINIO_VOLUMES=/minio\n      MINIO_OPTS=\"-C /etc/minio --address :80\"\n      MINIO_ACCESS_KEY=bad\n      MINIO_SECRET_KEY=Bad12345\n\n  - owner: root:root\n    path: /etc/systemd/system/minio.service\n    content: |\n      [Unit]\n      Description=MinIO\n      Documentation=https://docs.min.io\n      Wants=network-online.target\n      After=network-online.target\n      AssertFileIsExecutable=/usr/local/bin/minio\n\n      [Service]\n      WorkingDirectory=/usr/local/\n\n      User=minio-user\n      Group=minio-user\n\n      EnvironmentFile=/etc/default/minio\n      ExecStartPre=/bin/bash -c \"if [ -z \\\"${MINIO_VOLUMES}\\\" ]; then echo \\\"Variable MINIO_VOLUMES not set in /etc/default/minio\\\"; exit 1; fi\"\n\n      ExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES\n\n      # Let systemd restart this service always\n      Restart=always\n\n      # Specifies the maximum file descriptor number that can be opened by this process\n      LimitNOFILE=65536\n\n      # Disable timeout logic and wait until process is stopped\n      TimeoutStopSec=infinity\n      SendSIGKILL=no\n\n      [Install]\n      WantedBy=multi-user.target\n\n      # Built for ${project.name}-${project.version} (${project.name})\n\nruncmd:\n  - chown minio-user /minio\n  - chmod u+rxw /minio\n  - wget https://dl.minio.io/server/minio/release/linux-amd64/minio -P/tmp/\n  - wget https://dl.min.io/client/mc/release/linux-amd64/mc -P/tmp/\n  - chmod +x /tmp/minio\n  - chmod +x /tmp/mc\n  - mv /tmp/minio /usr/local/bin\n  - setcap cap_net_bind_service=+ep /usr/local/bin/minio\n  - mv /tmp/mc /usr/local/bin\n  - systemctl daemon-reload\n  - systemctl enable minio\n  - systemctl start minio\n  - mc config host add home http://localhost:80 bad Bad12345 --api \"s3v4\" --lookup \"dns\"\n  - mc admin user add home crash Crash12345\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname minio\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: minio\nfqdn: minio.bad\n\r\n--MIMEBOUNDARY--\r\n"
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_cloudinit_disk",
      "name": "mssymbols_commoninit",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/raid/terraform/libvirt-pool-home/mssymbols_commoninit.iso;5f1b53fc-0e88-6410-4532-4cce1bc55874",
            "meta_data": "",
            "name": "mssymbols_commoninit.iso",
            "network_config": "version: 2\nethernets:\n  ens3:\n    dhcp4: true\n",
            "pool": "home",
            "user_data": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\npackages:\n  - nginx\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mssymbolsdata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /proxy-cache, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\n\nwrite_files:\n  - owner: root:root\n    path: /etc/nginx/sites-available/default\n    content: |\n      proxy_cache_path /proxy-cache keys_zone=data:10m inactive=10000d;\n      client_max_body_size 200M;\n\n      resolver 8.8.8.8;\n\n      server {\n        listen 80 default_server;\n        server_name mssymbols.bad;\n\n        location / {\n          proxy_redirect off;\n          proxy_cache data;\n          proxy_cache_valid 200 404 406 10000d;\n          proxy_pass http://msdl.microsoft.com;\n          proxy_intercept_errors on;\n          error_page 301 302 307 = @handle_redirect;\n        }\n\n        location @handle_redirect {\n          set $saved_redirect_location '$upstream_http_location';\n          set $original_uri $uri;\n          set $orig_loc $upstream_http_location;\n          proxy_pass $orig_loc;\n          proxy_cache data;\n          proxy_cache_key $original_uri;\n          proxy_cache_valid 200 206 10000d;\n        }\n      }\n\nruncmd:\n  - mount /proxy-cache || true\n  - chmod -R 777 /proxy-cache\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname mssymbols\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: mssymbols\nfqdn: mssymbols.bad\n\r\n--MIMEBOUNDARY--\r\n"
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_cloudinit_disk",
      "name": "mysql_commoninit",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/raid/terraform/libvirt-pool-home/mysql_commoninit.iso;5f1b53f7-35b6-63ce-c3c5-7ace32c0851e",
            "meta_data": "",
            "name": "mysql_commoninit.iso",
            "network_config": "version: 2\nethernets:\n  ens3:\n    dhcp4: true\n",
            "pool": "home",
            "user_data": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\ndisk_setup:\n  /dev/vdb:\n    table_type: mbr\n    layout:\n      - 100\n    overwrite: False\n\nfs_setup:\n  - label: mysqldata\n    filesystem: ext4\n    device: /dev/vdb1\n    overwrite: false\n\nmounts:\n  - [ /dev/vdb1, /var/lib/mysql, auto, \"defaults,noexec\" ]\n\nmount_default_fields: [ None, None, \"auto\", \"defaults,nofail\", \"0\", \"2\" ]\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - echo \"mariadb-server-10.0 mysql-server/root_password password Bad123\" | debconf-set-selections\n  - echo \"mariadb-server-10.0 mysql-server/root_password_again password Bad123\" | debconf-set-selections\n  - apt-get -y install mariadb-server\n  - sed -i -e \"s/^bind-address/#bind-address/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - sed -i -e \"s/^skip-networking/#skip-networking/\" /etc/mysql/mariadb.conf.d/50-server.cnf\n  - mysql --user=\"root\" -e \"GRANT ALL ON *.* TO root@'%' IDENTIFIED BY 'Bad123' WITH GRANT OPTION;\"\n  - ufw default deny incoming\n  - ufw default allow outgoing\n  - ufw allow 3306/tcp\n  - echo \"y\" | ufw enable\n\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname mysql\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: mysql\nfqdn: mysql.bad\n\r\n--MIMEBOUNDARY--\r\n"
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_cloudinit_disk",
      "name": "zabbix_server_commoninit",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/raid/terraform/libvirt-pool-home/zabbix_server_commoninit.iso;5f1b53f6-ce6c-eb1a-5594-bfe247b1f755",
            "meta_data": "",
            "name": "zabbix_server_commoninit.iso",
            "network_config": "version: 2\nethernets:\n  ens3:\n    dhcp4: true\n",
            "pool": "home",
            "user_data": "Content-Type: multipart/mixed; boundary=\"MIMEBOUNDARY\"\nMIME-Version: 1.0\r\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"base.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nssh_pwauth: True\nchpasswd:\n  list: |\n     root:Bad123\n  expire: False\napt:\n  primary:\n    - arches: [default]\n      search:\n        - https://mirror.yandex.ru/ubuntu/\n        - http://archive.ubuntu.com\n\npackage_update: true\npackage_upgrade: true\napt_update: true\napt_upgrade: true\npackages:\n  - qemu-guest-agent\n\npower_state:\n  delay: \"+1\"\n  mode: reboot\n  message: Reboot from Cloud Init\n  timeout: 5\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"zabbix_agent.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\npackages:\n  - zabbix-agent\n\nwrite_files:\n  - owner: root:root\n    path: /etc/zabbix/zabbix_agentd.d/server.conf\n    permissions: '0644'\n    content: |\n      Server=zabbix.bad\n      ServerActive=zabbix.bad\n      HostMetadata=LINUX server\n\nruncmd:\n  - sed -i 's/.*Hostname=/#\u0026/' /etc/zabbix/zabbix_agentd.conf\n  - ufw allow 10050/tcp\n  - systemctl enable zabbix-agent.service\n  - service zabbix-agent restart\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"master.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nsystem_info:\n  apt_get_command: ['apt-get', '--option=Dpkg::Options::=--force-confold', '--option=Dpkg::options::=--force-unsafe-io', '--assume-yes', '--quiet', '--no-install-recommends']\n\napt:\n  sources:\n    zabbix:\n      source: \"deb http://repo.zabbix.com/zabbix/4.4/ubuntu bionic main\"\n      key: |\n        -----BEGIN PGP PUBLIC KEY BLOCK-----\n        Version: GnuPG v1.4.10 (GNU/Linux)\n\n        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\n        ui+/5ZJHakC67t5OgbMas3Hz4Q==\n        =HHRW\n        -----END PGP PUBLIC KEY BLOCK-----\n\nwrite_files:\n  - owner: root:root\n    path: /zabbix.sql\n    content: |\n      SET @s = IF(version() \u003c 8 OR version() LIKE '%MariaDB%',\n            'SET GLOBAL innodb_file_per_table = ON,\n                        innodb_file_format = Barracuda,\n                        innodb_large_prefix = ON;',\n            'SET GLOBAL innodb_file_per_table = ON;');\n      PREPARE stmt1 FROM @s;\n      EXECUTE stmt1;\n\n      --DROP DATABASE IF EXISTS zabbix;\n      CREATE DATABASE IF NOT EXISTS zabbix CHARACTER SET utf8 collate utf8_bin;\n      CREATE USER IF NOT EXISTS 'zabbix'@'%' IDENTIFIED BY 'ZabbixPasswordIsComplex123';\n      GRANT ALL ON zabbix.* TO zabbix@'%';\n      flush privileges;\n\n  - owner: www-data:www-data\n    path: /etc/zabbix/web/zabbix.conf.php\n    permissions: '0644'\n    content: |\n      \u003c?php\n      // Zabbix GUI configuration file.\n      global $DB;\n\n      $DB['TYPE']     = 'MYSQL';\n      $DB['SERVER']   = 'mysql.bad';\n      $DB['PORT']     = '0';\n      $DB['DATABASE'] = 'zabbix';\n      $DB['USER']     = 'zabbix';\n      $DB['PASSWORD'] = 'ZabbixPasswordIsComplex123';\n\n      // Schema name. Used for IBM DB2 and PostgreSQL.\n      $DB['SCHEMA'] = '';\n\n      $ZBX_SERVER      = 'localhost';\n      $ZBX_SERVER_PORT = '10051';\n      $ZBX_SERVER_NAME = '';\n\n      $IMAGE_FORMAT_DEFAULT = IMAGE_FORMAT_PNG;\n\npackages:\n  - zabbix-server-mysql\n  - zabbix-frontend-php\n  - zabbix-apache-conf\n\nswap:\n  filename: /swap.img\n  size: \"auto\"\n  maxsize: 2147483648\n\nruncmd:\n  - until nc -vzw 2 mysql.bad 3306; do sleep 2; done\n  - mysql -hmysql.bad -uroot -pBad123 \u003c /zabbix.sql\n  - 'zcat /usr/share/doc/zabbix-server-mysql/create.sql.gz | mysql -hmysql.bad -uzabbix -pZabbixPasswordIsComplex123 -Dzabbix'\n  - sed -i s'#\\# DBPassword=#DBPassword=ZabbixPasswordIsComplex123#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# DBHost=localhost#DBHost=mysql.bad#g' /etc/zabbix/zabbix_server.conf\n  - sed -i s'#\\# php_value date.timezone Europe/Riga#php_value date.timezone Europe/Samara#g' /etc/apache2/conf-enabled/zabbix.conf\n  - systemctl enable zabbix-server.service\n\n\r\n--MIMEBOUNDARY\r\nContent-Disposition: attachment; filename=\"hostname.cfg\"\r\nContent-Transfer-Encoding: 7bit\r\nContent-Type: text/cloud-config\r\nMime-Version: 1.0\r\n\r\n#cloud-config\nmerge_how: dict(recurse_array)+list(append)\n\nbootcmd:\n- 'sed -i \"/preserve_hostname: false/c\\preserve_hostname: true\" /etc/cloud/cloud.cfg'\n- hostnamectl set-hostname zabbix\n- for i in {1..10}; do dhclient; done\n- for i in {1..10}; do dhclient -r; done\n- systemctl daemon-reload \u0026\u0026 service systemd-networkd restart\n\nhostname: zabbix\nfqdn: zabbix.bad\n\r\n--MIMEBOUNDARY--\r\n"
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_domain",
      "name": "dev",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arch": "x86_64",
            "autostart": true,
            "boot_device": [],
            "cloudinit": "/raid/terraform/libvirt-pool-home/dev_commoninit.iso;5f1b53f6-c88d-2af7-10e2-ba86b36da69a",
            "cmdline": [],
            "console": [
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "0",
                "target_type": "serial",
                "type": "pty"
              },
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "1",
                "target_type": "virtio",
                "type": "pty"
              }
            ],
            "coreos_ignition": null,
            "cpu": null,
            "disk": [
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/dev-os-no",
                "wwn": ""
              }
            ],
            "emulator": "/usr/bin/qemu-system-x86_64",
            "filesystem": [],
            "firmware": "",
            "fw_cfg_name": "opt/com.coreos/config",
            "graphics": [
              {
                "autoport": true,
                "listen_address": "127.0.0.1",
                "listen_type": "address",
                "type": "spice"
              }
            ],
            "id": "d85ded00-46ee-47e1-8c1f-1dc37c463552",
            "initrd": "",
            "kernel": "",
            "machine": "ubuntu",
            "memory": 4096,
            "metadata": null,
            "name": "dev-terraform-no",
            "network_interface": [
              {
                "addresses": [],
                "bridge": "br0",
                "hostname": "",
                "mac": "52:54:00:12:69:06",
                "macvtap": "",
                "network_id": "",
                "network_name": "",
                "passthrough": "",
                "vepa": "",
                "wait_for_lease": false
              }
            ],
            "nvram": [],
            "qemu_agent": false,
            "running": true,
            "timeouts": null,
            "vcpu": 4,
            "video": [],
            "xml": []
          },
          "dependencies": [
            "libvirt_cloudinit_disk.dev_commoninit",
            "libvirt_pool.home",
            "libvirt_volume.dev-os",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_domain",
      "name": "gitea",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arch": "x86_64",
            "autostart": true,
            "boot_device": [],
            "cloudinit": "/raid/terraform/libvirt-pool-home/gitea_commoninit.iso;5f1b53fc-0c03-642b-b8a3-b5460100b3e2",
            "cmdline": null,
            "console": [
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "0",
                "target_type": "serial",
                "type": "pty"
              },
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "1",
                "target_type": "virtio",
                "type": "pty"
              }
            ],
            "coreos_ignition": null,
            "cpu": null,
            "disk": [
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/gitea-os-v1",
                "wwn": ""
              },
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/gitea-data-static",
                "wwn": ""
              }
            ],
            "emulator": "/usr/bin/qemu-system-x86_64",
            "filesystem": [],
            "firmware": "",
            "fw_cfg_name": "opt/com.coreos/config",
            "graphics": [
              {
                "autoport": true,
                "listen_address": "127.0.0.1",
                "listen_type": "address",
                "type": "spice"
              }
            ],
            "id": "13a7517a-dbf0-4993-89f7-f3aee9c83548",
            "initrd": "",
            "kernel": "",
            "machine": "ubuntu",
            "memory": 1024,
            "metadata": null,
            "name": "gitea-terraform-v1",
            "network_interface": [
              {
                "addresses": [],
                "bridge": "br0",
                "hostname": "",
                "mac": "52:54:00:12:69:07",
                "macvtap": "",
                "network_id": "",
                "network_name": "",
                "passthrough": "",
                "vepa": "",
                "wait_for_lease": false
              }
            ],
            "nvram": [],
            "qemu_agent": false,
            "running": true,
            "timeouts": null,
            "vcpu": 4,
            "video": [],
            "xml": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "libvirt_cloudinit_disk.gitea_commoninit",
            "libvirt_pool.home",
            "libvirt_volume.gitea-data",
            "libvirt_volume.gitea-os",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_domain",
      "name": "minio",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arch": "x86_64",
            "autostart": true,
            "boot_device": [],
            "cloudinit": "/raid/terraform/libvirt-pool-home/minio_commoninit.iso;5f1b53f6-df43-e8d0-562f-69a0a7652d87",
            "cmdline": [],
            "console": [
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "0",
                "target_type": "serial",
                "type": "pty"
              },
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "1",
                "target_type": "virtio",
                "type": "pty"
              }
            ],
            "coreos_ignition": null,
            "cpu": null,
            "disk": [
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/minio-os-v1",
                "wwn": ""
              },
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/minio-data",
                "wwn": ""
              }
            ],
            "emulator": "/usr/bin/qemu-system-x86_64",
            "filesystem": [],
            "firmware": "",
            "fw_cfg_name": "opt/com.coreos/config",
            "graphics": [
              {
                "autoport": true,
                "listen_address": "127.0.0.1",
                "listen_type": "address",
                "type": "spice"
              }
            ],
            "id": "106542eb-a307-42e7-9b09-4f7cf58af3e1",
            "initrd": "",
            "kernel": "",
            "machine": "ubuntu",
            "memory": 1024,
            "metadata": null,
            "name": "minio-terraform-v1",
            "network_interface": [
              {
                "addresses": [],
                "bridge": "br0",
                "hostname": "",
                "mac": "52:54:00:12:69:05",
                "macvtap": "",
                "network_id": "",
                "network_name": "",
                "passthrough": "",
                "vepa": "",
                "wait_for_lease": false
              }
            ],
            "nvram": [],
            "qemu_agent": false,
            "running": true,
            "timeouts": null,
            "vcpu": 4,
            "video": [],
            "xml": []
          },
          "dependencies": [
            "libvirt_cloudinit_disk.minio_commoninit",
            "libvirt_pool.home",
            "libvirt_volume.minio-data",
            "libvirt_volume.minio-os",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_domain",
      "name": "mssymbols",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arch": "x86_64",
            "autostart": true,
            "boot_device": [],
            "cloudinit": "/raid/terraform/libvirt-pool-home/mssymbols_commoninit.iso;5f1b53fc-0e88-6410-4532-4cce1bc55874",
            "cmdline": [],
            "console": [
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "0",
                "target_type": "serial",
                "type": "pty"
              },
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "1",
                "target_type": "virtio",
                "type": "pty"
              }
            ],
            "coreos_ignition": null,
            "cpu": null,
            "disk": [
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/mssymbols-os-v1",
                "wwn": ""
              },
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/mssymbols-data",
                "wwn": ""
              }
            ],
            "emulator": "/usr/bin/qemu-system-x86_64",
            "filesystem": [],
            "firmware": "",
            "fw_cfg_name": "opt/com.coreos/config",
            "graphics": [
              {
                "autoport": true,
                "listen_address": "127.0.0.1",
                "listen_type": "address",
                "type": "spice"
              }
            ],
            "id": "07bce36f-6ddc-4b1f-a847-bd58476314db",
            "initrd": "",
            "kernel": "",
            "machine": "ubuntu",
            "memory": 1024,
            "metadata": null,
            "name": "mssymbols-terraform-v1",
            "network_interface": [
              {
                "addresses": [],
                "bridge": "br0",
                "hostname": "",
                "mac": "52:54:00:12:69:04",
                "macvtap": "",
                "network_id": "",
                "network_name": "",
                "passthrough": "",
                "vepa": "",
                "wait_for_lease": false
              }
            ],
            "nvram": [],
            "qemu_agent": false,
            "running": true,
            "timeouts": null,
            "vcpu": 4,
            "video": [],
            "xml": []
          },
          "dependencies": [
            "libvirt_cloudinit_disk.mssymbols_commoninit",
            "libvirt_pool.home",
            "libvirt_volume.mssymbols-data",
            "libvirt_volume.mssymbols-os",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_domain",
      "name": "mysql",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arch": "x86_64",
            "autostart": true,
            "boot_device": [],
            "cloudinit": "/raid/terraform/libvirt-pool-home/mysql_commoninit.iso;5f1b53f7-35b6-63ce-c3c5-7ace32c0851e",
            "cmdline": [],
            "console": [
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "0",
                "target_type": "serial",
                "type": "pty"
              },
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "1",
                "target_type": "virtio",
                "type": "pty"
              }
            ],
            "coreos_ignition": null,
            "cpu": null,
            "disk": [
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/mysql-os-v1",
                "wwn": ""
              },
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/mysql-data",
                "wwn": ""
              }
            ],
            "emulator": "/usr/bin/qemu-system-x86_64",
            "filesystem": [],
            "firmware": "",
            "fw_cfg_name": "opt/com.coreos/config",
            "graphics": [
              {
                "autoport": true,
                "listen_address": "127.0.0.1",
                "listen_type": "address",
                "type": "spice"
              }
            ],
            "id": "e1c54daf-afbb-40f5-8c91-a44bcc645722",
            "initrd": "",
            "kernel": "",
            "machine": "ubuntu",
            "memory": 1024,
            "metadata": null,
            "name": "mysql-terraform-v1",
            "network_interface": [
              {
                "addresses": [],
                "bridge": "br0",
                "hostname": "",
                "mac": "52:54:00:12:69:02",
                "macvtap": "",
                "network_id": "",
                "network_name": "",
                "passthrough": "",
                "vepa": "",
                "wait_for_lease": false
              }
            ],
            "nvram": [],
            "qemu_agent": false,
            "running": true,
            "timeouts": null,
            "vcpu": 4,
            "video": [],
            "xml": []
          },
          "dependencies": [
            "libvirt_cloudinit_disk.mysql_commoninit",
            "libvirt_pool.home",
            "libvirt_volume.mysql-data",
            "libvirt_volume.mysql-os",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_domain",
      "name": "zabbix-server",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arch": "x86_64",
            "autostart": true,
            "boot_device": [],
            "cloudinit": "/raid/terraform/libvirt-pool-home/zabbix_server_commoninit.iso;5f1b53f6-ce6c-eb1a-5594-bfe247b1f755",
            "cmdline": [],
            "console": [
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "0",
                "target_type": "serial",
                "type": "pty"
              },
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "1",
                "target_type": "virtio",
                "type": "pty"
              }
            ],
            "coreos_ignition": null,
            "cpu": null,
            "disk": [
              {
                "file": "",
                "scsi": false,
                "url": "",
                "volume_id": "/raid/terraform/libvirt-pool-home/zabbix-server-os-v1",
                "wwn": ""
              }
            ],
            "emulator": "/usr/bin/qemu-system-x86_64",
            "filesystem": [],
            "firmware": "",
            "fw_cfg_name": "opt/com.coreos/config",
            "graphics": [
              {
                "autoport": true,
                "listen_address": "127.0.0.1",
                "listen_type": "address",
                "type": "spice"
              }
            ],
            "id": "a5d90081-31ef-432f-bb53-b5edbb4c0397",
            "initrd": "",
            "kernel": "",
            "machine": "ubuntu",
            "memory": 1024,
            "metadata": null,
            "name": "zabbix-server-terraform-v1",
            "network_interface": [
              {
                "addresses": [],
                "bridge": "br0",
                "hostname": "",
                "mac": "52:54:00:12:69:03",
                "macvtap": "",
                "network_id": "",
                "network_name": "",
                "passthrough": "",
                "vepa": "",
                "wait_for_lease": false
              }
            ],
            "nvram": [],
            "qemu_agent": false,
            "running": true,
            "timeouts": null,
            "vcpu": 4,
            "video": [],
            "xml": []
          },
          "dependencies": [
            "libvirt_cloudinit_disk.zabbix_server_commoninit",
            "libvirt_pool.home",
            "libvirt_volume.ubuntu18",
            "libvirt_volume.zabbix-server-os"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_pool",
      "name": "home",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "allocation": 822943354880,
            "available": null,
            "capacity": 1999285899264,
            "id": "8978a594-64d6-4704-9e09-56a92d43381a",
            "name": "home",
            "path": "/raid/terraform/libvirt-pool-home",
            "type": "dir",
            "xml": []
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "dev-os",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": "/raid/terraform/libvirt-pool-home/ubuntu18-base-qcow2",
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/dev-os-no",
            "name": "dev-os-no",
            "pool": "home",
            "size": 107374182400,
            "source": null,
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "gitea-data",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": null,
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/gitea-data-static",
            "name": "gitea-data-static",
            "pool": "home",
            "size": 1073741824000,
            "source": null,
            "xml": []
          },
          "private": "bnVsbA==",
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "gitea-os",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": "/raid/terraform/libvirt-pool-home/ubuntu18-base-qcow2",
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/gitea-os-v1",
            "name": "gitea-os-v1",
            "pool": "home",
            "size": 10737418240,
            "source": null,
            "xml": []
          },
          "private": "bnVsbA==",
          "dependencies": [
            "libvirt_pool.home",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "minio-data",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": null,
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/minio-data",
            "name": "minio-data",
            "pool": "home",
            "size": 1073741824000,
            "source": null,
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "minio-os",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": "/raid/terraform/libvirt-pool-home/ubuntu18-base-qcow2",
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/minio-os-v1",
            "name": "minio-os-v1",
            "pool": "home",
            "size": 10737418240,
            "source": null,
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "mssymbols-data",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": null,
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/mssymbols-data",
            "name": "mssymbols-data",
            "pool": "home",
            "size": 107374182400,
            "source": null,
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "mssymbols-os",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": "/raid/terraform/libvirt-pool-home/ubuntu18-base-qcow2",
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/mssymbols-os-v1",
            "name": "mssymbols-os-v1",
            "pool": "home",
            "size": 10737418240,
            "source": null,
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "mysql-data",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": null,
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/mysql-data",
            "name": "mysql-data",
            "pool": "home",
            "size": 107374182400,
            "source": null,
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "mysql-os",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": "/raid/terraform/libvirt-pool-home/ubuntu18-base-qcow2",
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/mysql-os-v1",
            "name": "mysql-os-v1",
            "pool": "home",
            "size": 10737418240,
            "source": null,
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "ubuntu16",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": null,
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/ubuntu16-base-qcow2",
            "name": "ubuntu16-base-qcow2",
            "pool": "home",
            "size": 2361393152,
            "source": "https://cloud-images.ubuntu.com/releases/xenial/release/ubuntu-16.04-server-cloudimg-amd64-disk1.img",
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "ubuntu18",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": null,
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/ubuntu18-base-qcow2",
            "name": "ubuntu18-base-qcow2",
            "pool": "home",
            "size": 2361393152,
            "source": "https://cloud-images.ubuntu.com/releases/bionic/release/ubuntu-18.04-server-cloudimg-amd64.img",
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "zabbix-server-os",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": "/raid/terraform/libvirt-pool-home/ubuntu18-base-qcow2",
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/raid/terraform/libvirt-pool-home/zabbix-server-os-v1",
            "name": "zabbix-server-os-v1",
            "pool": "home",
            "size": 10737418240,
            "source": null,
            "xml": []
          },
          "dependencies": [
            "libvirt_pool.home",
            "libvirt_volume.ubuntu18"
          ]
        }
      ]
    }
  ]
}
